<%= render 'shared/header' %>

<div class='container my-24 mx-auto'>
  <div class='flex flex-col mx-auto text-xs sm:text-base text-gray-600'>
    <section class="text-center bg-white rounded">
      <h1 class="text-base sm:text-3xl text-blue-900 font-bold pt-5">Let's Comfortable Remote Work！</h1>
      <div class="flex grid sm:grid-cols-2 grid-cols-1">
        <img src="assets/Manager _Isometric.png" alt="デスクの写真" width="400" heigth="400" class="mx-auto">
        <div class="my-auto w-full">
        <p class="text-base font-bold">リモートワークの悩みを解消しよう！</p>
          <%= form_tag(posts_path, method: :get) do %>
            <div class='flex mx-3 my-2 border border-gray-300 rounded-full p-1 focus:outline-none focus:ring focus:ring-blue-100 focus:border-blue-200'>
              <%= text_field_tag :search, "", placeholder: "search....", class: 'w-full inline-block mx-2 focus:outline-none' %>
              <%= submit_tag "検索", name: :nil, class:"inline-block my-auto text-sm text-white bg-blue-900 rounded-full py-1 px-2 cursor-pointer focus:outline-none　transition duration-200 ease-in-out hover:bg-gray-500" %>
            </div>
          <% end %>
          <div class="p-4 rounded w-full">
          <p class="font-bold mb-3">人気のタグ一覧</p>
            <% @tag_list.each do |list| %>
              <%= link_to "##{list.tag_name}", tag_posts_path(tag_id: list.id), class: 'inline-block align-middle bg-gray-400 text-white rounded-full p-1 m-1' %>
              <%= "(#{list.posts.count})" %>
            <% end %>
          </div>
        </div>
      </div>
    </section>
    <section class="mx-auto my-5 bg-white rounded">
      <div class="flex grid grid-cols-1 sm:grid-cols-2 text-center p-4 gap-3">
        <div>職種一覧<%= pie_chart User.group(:job).order('count_all DESC').count %></div>
        <div>改善されたこと<%= pie_chart Post.group(:issue).order('count_all DESC').count %></div>
      </div>
    </section>
    <%= link_to new_post_path do %>
      <i class="far fa-edit text-3xl fixed right-14 bottom-14 text-white rounded-full transition duration-200 ease-in-out bg-blue-900 hover:bg-gray-500 p-4 sm:p-6 "></i>
    <% end %>
    <div class="grid grid-cols-1 sm:grid-cols-4 mx-auto gap-7 text-gray-600">
    <% @posts.each do |post| %>
      <div class='overflow-hidden rounded-lg shadow-lg bg-white'>
        <%= link_to post do %>
          <%= image_tag post.image.url(:small), class: 'block h-auto w-full' %>
          <div class="flex justify-between items-center p-2 leading-tight">
            <p class='inline-block text-base'><%= post.title.truncate(10) %></p>
            <p class='text-xs'><%= time_ago_in_words(post.created_at) %>前</p>
          </div>
          <div class="flex justify-between items-center p-2 leading-tight text-xs">
            <% if post.user.avatar? %>
              <%= image_tag post.user.avatar.url, id: 'preview', class: 'inline-block h-7 w-7 shadow-xl transition duration-200 ease-in-out rounded-full cursor-pointer hover:opacity-70' %>
            <% else %>
              <%= image_tag '/assets/default.png', id: 'preview', alt: 'ユーザーアイコン', class: 'inline-block h-7 w-7 shadow-xl transition duration-200 ease-in-out rounded-full cursor-pointer hover:opacity-70' %>
            <% end %>
            <p><%= post.user.name %></p>
            <p>職種:<%= post.user.job %></p>
            <div id="likes_buttons_<%= post.id %>">
              <%= render partial: 'likes/like', locals: { post: post } %>
            </div>
          </div>
            <div class="p-2">
              <% post.tags.each do |tag|%>
                <%= link_to "##{tag.tag_name}", tag_posts_path(tag), class: "text-xs inline-block bg-gray-400 text-white rounded-full p-1" %>
              <% end %>
            </div>
        <% end %>
      </div>
    <% end %>
  </div>
  <div class="mt-10 mx-auto text-center text-xl">
    <%= paginate @posts %>
  </div>
</div>
